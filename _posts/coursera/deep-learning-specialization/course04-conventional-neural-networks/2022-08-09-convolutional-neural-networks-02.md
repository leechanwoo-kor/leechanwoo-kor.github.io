---
title: "[Ⅵ. Convolutional Neural Networks] Convolutional Neural Networks (2)"
categories:
  - Deep Learning Specialization
tags:
  - Coursera
  - Deep Learning Specialization
  - Deep Learning
  - Facial Recognition System
  - Convolutional Neural Network
  - Tensorflow
  - Object Detection and Segmentation
toc: true
toc_sticky: true
toc_label: "Convolutional Neural Networks (2)"
toc_icon: "sticky-note"
---

![image](https://user-images.githubusercontent.com/55765292/183551502-3482e2d7-efb0-4815-9c94-b662606b4842.png){: width="50%" height="50%"}{: .align-center}

<br><br>

# Convolutional Neural Networks

## Foundations of Convolutional Neural Networks

### More Edge Detection

합성곱 연산을 통해 수직 엣지 검출기를 구현하는 방법을 살펴 보았습니다. 이번에는 포지티브 엣지와 네거티브 엣지 사이의 차이 즉 밝은 엣지에서 어두운 엣지 반대 경우의 전환의 차이에 대해 알아보겠습니다. 또한 지금까지 해왔던 것처럼 엣지 검출기를 손으로 코딩하는 대신 다른 유형의 엣지 검출기와 알고리즘을 학습하는 방법도 학습하게 될 것입니다.

---

![image](https://user-images.githubusercontent.com/55765292/183600083-9143e2a8-943f-45b6-96ac-96650bd3b176.png)

이전에 사용했던 예시입니다. 6 x 6의 왼쪽은 밝고 오른쪽은 어두운 이 이미지를 수직 엣지 검출 필터와 컨볼브해서 이미지 가운데에 수직
엣지가 검출되도록 했습니다. 색상이 뒤집힌 이미지에서 왼쪽은 어둡고 오른쪽이 더 밝아지면 어떻게 될까요?

그러면 10 은 이미지의 오른쪽, 0은 왼쪽에 위치하게 됩니다. 이것을 동일한 엣지 검출 필터로 컨볼브하면 중간 부분은 30이 아닌 -30이 도출되며 이미지는 이렇게 됩니다. 전환되는 명암이 반대로 되기 때문에 30도 뒤바뀌게 됩니다. 그리고 - 30은 이것이 밝은 색에서 어두운 색으로 바뀌는 것이 아니라 어두운 색에서 밝은 색으로 바뀌는 것임을 보여줍니다.

그리고 이 두 가지 경우 중 어느 것인지 상관하지 않는다면 이 출력 행렬의 절대값을 취할 수 있습니다. 그러나 이 특정 필터는 밝은 색에서 어두운 색으로 변하는 엣지와 어두운 색에서 밝은 색으로 변화하는 엣지의 차이점을 만들어냅니다. 엣지 검출의 예시를 좀 더 보도록 하겠습니다.

---

![image](https://user-images.githubusercontent.com/55765292/183600543-91b44819-c9d5-4287-9fbd-da9b115d60cd.png)

이전에 봤던 이 3 x 3 필터를 사용하면 수직 엣지를 검출할 수 있습니다. 따라서 이 3 x 3 필터를 사용하여 수평 엣지를 검출할 수 있다는 사실이 놀랍지 않습니다. 참고로 이 필터에 의한 수직 엣지의 픽셀은 왼쪽은 상대적으로 밝고 오른쪽에서 상대적으로 어두운 3 x 3 영역입니다. 마찬가지로 수평 엣지는 픽셀이 위쪽이 상대적으로 밝고 아래쪽 행이 상대적으로 어두운 3 x 3 영역이 됩니다.

예시가 하나 있는데 이 예시는 조금 더 복잡합니다. 좌측 상단과 우측 하단 코너에는 10이 있습니다. 따라서 이것을 이미지로 그리면 0이 있는 곳이 더 어두워지기 때문에 어둡게 칠하고 왼쪽 상단과 오른쪽 하단은 더 밝을 것입니다.

이것을 수평 엣지 검출기와 컨볼브하면 이렇게 됩니다. 몇 가지 예시를 보겠습니다. 이 30은 이 3 x 3영역에 대응하는데요. 상단에는 밝은 픽셀이 있고 하단에는 어두운 픽셀이 있습니다. 바로 여기입니다. 강한 포지티브 엣지를 발견할 수 있습니다. 그리고 -30은 이 영역에 대응하게 되는데  하단은 더 밝고 상단은 더 어둡습니다. 이것이 바로 네거티브 엣지의 예시입니다.

다시 말해서, 우리가 6 x 6같은 상대적으로 작은 이미지로 작업하고 있다는 것을 보여주는 증거입니다. 그러나 예를 들어 -10같은 이 중간 값들은 왼쪽의 포지티브 엣지 부분을 담아내고 오른쪽에 네거티브 엣지를 담아낸다는 사실을 보여주고 그것들을 함께 섞으면 중간 값을 얻게 됩니다.

그러나 예를 들어 체크판 패턴의 1000 x 1000 이미지처럼 매우 큰 경우 10의 전환 영역을 볼 수 없습니다. 중간 값은 이미지의 사이즈에 비해 꽤 작습니다.

요약하자면 다양한 필터를 사용하여 수직 및 수평 엣지를 찾을 수 있습니다.

---

![image](https://user-images.githubusercontent.com/55765292/183600571-748ac159-5e43-49e9-88c5-9a66bee87b71.png)

우리가 사용한 3 x 3 수직 엣지 검출 필터는 하나의 가능한 선택입니다. 역사적으로 컴퓨터 비전 문헌에서최고의 숫자 집합이 무엇인지에 대해 상당한 양의 논쟁이 있었습니다.

따라서 여러분이 사용할 수 있는 또 다른 것은 아마도 1, 2 1, 0, 0, 0, -1, -2, -1 일겁니다. 이것을 **소벨** 필터라고 합니다. 이것의 장점은 중앙 행, 중앙 픽셀에 조금 더 무게를 실어 이것을 조금 더 견고하게 만든다는 것입니다.

하지만 컴퓨터 비전 연구원들은 1, 2, 1 대신 3, 10, 3이 되는 다른 숫자들을 사용할 것 같군요. 그러면 -3, -10, -3이 되겠죠. 이것을 **샤르** 필터라고 합니다.

이것은 약간 다른 특징을 갖고 있습니다. 그리고 오직 수직 엣지 검출만을 위한 것입니다. 이것을 90도 돌리면 수직 엣지 검출을 볼 수 있습니다. 딥 러닝의 등장과 함께 우리가 배운 것 중 하나는 복잡한 이미지에서 엣지를 감지할 때 컴퓨터 비전 연구원이 이 9개의 숫자를 직접 선택하도록 할 필요가 없다는 것입니다.

아마도 여러분은 그것들을 배우고 역 전파를 통해 배울 수 있는 이 행렬의 9개의 숫자를 매개 변수로 다루게 될 것입니다. 목표는 9개의 매개변수를 학습하여 6 x 6 이미지로 만들고 이를 3 x 3 필터로 컨볼브하여 좋은 엣지 검출기를 제공하는 것입니다.

이후에는 이 9개의 숫자를 매개 변수로 취급함으로 역 전파가 1, 1, 1, 0, 0, 0, -1, -1을 학습하거나 혹은 소벨 필터나 샤르 필터를 학습하거나, 손으로 코딩한 필터보다 데이터 통계를 캡처하는 데 훨씬 더 나은 다른 것을 배우게 될 것입니다. 그리고 수직 및 수평 엣지가 아닌 45도, 70도, 73도 또는 선택한 방향에 있는 엣지를 감지하는 방법을 배우게 될 것입니다.

그리고 이 모든 숫자들을 매개 변수가 되게 하고 데이터로부터 자동으로 학습함으로써 컴퓨터 비전 연구원들이 일반적으로 손으로 코딩할 수 있는 것보다 훨씬 더 강력하게 신경망이 실제로 낮은 수준의 특징을 배울 수 있다는 것을 알게 되었습니다.

이 모든 계산에는 여전히 합성곱 연산이 근간에 있으며 이 작업을 통해 역전파는 원하는 3 x 3 필터를 학습한 다음 전체 이미지, 이 위치, 이 위치, 이 위치에 적용할 수 있습니다. 기능을 작동하기 위해 수직 엣지, 수평 엣지, 또는 다른 각도의 엣지 또는 영어로 이름조차 없는 다른 필터인지 감지하려고 합니다.

---

따라서 이 9개의 숫자를 학습할 매개변수로 취급할 수 있다는 아이디어는 컴퓨터 비전에서 가장 강력한 아이디어 중 하나였습니다. 이후에는 실제로 이 9개의 숫자를 학습하기 위해 역 전파를 사용하는 방법에 대해 알아보겠습니다.

하지만 먼저 기본 합성곱 연산에 대한 몇 가지 다른 세부 사항 다른 변형에 대해 알아보겠습니다. 이어서 패딩을 사용하는 방법과 합성곱에 대해 다양한 스트라이드를 사용하는 방법에 대해 논의하고 싶습니다. 이 두 가지가 합성곱 신경망 빌딩블록의 중요한 요소들이 될 것입니다.

---

### Padding

![image](https://user-images.githubusercontent.com/55765292/183630969-5b427266-e16c-40f1-8a72-ce5e5902be87.png)

---

![image](https://user-images.githubusercontent.com/55765292/183631024-b9b11f93-bb98-4a04-af2e-75ed6aab366e.png)
