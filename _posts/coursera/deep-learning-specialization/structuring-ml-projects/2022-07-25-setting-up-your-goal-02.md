---
title: "[Ⅲ. Structuring Machine Learning Projects] Setting Up your Goal (2)"
categories:
  - Deep Learning Specialization
tags:
  - Coursera
  - Deep Learning Specialization
  - Deep Learning
  - Inductive Transfer
  - Machine Learning
  - Multi-Task Learning
  - Decision-Making
toc: true
toc_sticky: true
toc_label: "Setting Up your Goal (2)"
toc_icon: "sticky-note"
---

![image](https://user-images.githubusercontent.com/55765292/179931579-167db454-5d9d-4e0d-a8fe-454770dc97a6.png){: width="50%" height="50%"}{: .align-center}

<br><br>

# Structuring Machine Learning Projects

## Setting Up your Goal

### Train/Dev/Test Distributions
훈련 개발이나 개발 세트 또는 시험 세트를 어떻게 설정하는지에 따라 본인이나 팀의 머신러닝 프로젝트 진전 속도가 크게 달라질 수 있습니다. 심지어 대기업 소속 팀들도 팀의 진행 속도를 가속화하기보다는 더디게 만드는 데이터 세트를 구성합니다. 어떻게 하면 데이터 세트를 잘 만들어 팀의 생산성을 최대화할 수 있는지 알아보도록 하겠습니다.

---

![image](https://user-images.githubusercontent.com/55765292/180713675-108e057b-88a9-4e76-9082-65dadead1a1c.png)

이번 영상에서는 개발과 시험 세트의 설정 방법에 대해 집중적으로 말씀드리겠습니다. 데브 세트(개발 세트)는 디벨롭먼트 세트라고도 불리는데요. 홀드-아웃 교차 검증 세트라고도 합니다. 일반적인 머신러닝의 워크플로는 다양한 아이디어를 시도해 보고 다양한 모델을 훈련 세트에서 훈련시켜 보고 개발 세트를 이용해 여러 아이디어를 평가한 뒤 그 중 하나를 고르는 것입니다.

개발 세트의 성능 개선을 위해 지속적으로 혁신해 마지막에는 한 가지 마음에 드는 항목을 골라 시험 세트에서 평가해보는 것입니다. 예를 들어 고양이 분류기를 만들고 있다고 해 봅시다. 그리고 미국, 영국, 유럽, 남아메리카 인도, 중국, 기타 아시아 국가, 호주에서 운영을 하고 있다고 생각해 봅시다. 이 때 개발 세트와 시험 세트를 어떻게 설정하면 좋을까요?

한가지 방법은 앞서 언급한 지역 중 네 가지를 고르는 것입니다. 저는 이렇게 네 개를 쓰겠지만 랜덤으로 뽑을 수도 있겠죠. 이 네 가지 지역에서 수집된 데이터가 개발 세트로 이관될 텐데요. 나머지 네 개의 지역은 무작위로 선별해도 되고요. 이들 지역은 시험 세트로 이동시키도록 하겠습니다. 그런데 이번 사례에서는 이렇게 고르는 게 부적합한 것으로 드러났습니다. 개발 세트와 시험 세트가 모두 다른 분포도를 갖고 있어서요. 대신 개발 세트와 시험 세트가 같은 분포에서 나올 것을 권장드립니다.

정확히 무슨 뜻인지 알려드리죠. 기억하셔야 할 것은 개발 세트와 단일 역할번호 평가 지표를 설정하는 것입니다. 이는 목표를 설정하고 팀에게 목표 과녁의 중심이 어딘지 알려주는 것과 같습니다. 일단 개발 세트와 지표를 수립하고 나면 팀이 빠르게 반복 수행을 할 수 있고 다양한 아이디어를 시도해 보고 실험도 해 보고 빠르게 개발 세트를 이용하고 지표를 사용해 분류기를 평가하고
가장 좋은 것을 고를 수 있습니다.

머신러닝 팀은 과녁에 다양한 화살을 쏴서 명중 확률을 높이는 데 뛰어날 수 있습니다. 그래서 개발 세트 지표에서 잘할 수 있도록 하는 것이죠. 왼쪽 예시에서 보이는 개발과 시험 세트에서 설정한 예시의 문제는 팀이 개발 세트에서 몇 달간 노력했더라도 막상 시험 세트에서 시현해 볼 때는 이 네 개 국가나 아래 네 지역에서 얻은 데이터가 개발 세트의 지역과 아주 많이 다를 수 있습니다. 자칫하면 끔찍한 서프라이즈를 볼 수 있는 것이죠.

개발 세트 최적화를 위해 수 개월을 썼지만 시험 세트의 좋은 성능으로 이어지지 않는 것이요. 분포도가 다른 곳에서 만들어진 개발 세트와 시험 세트를 갖는 것은 마치 몇 개월 동안 계속해서
과녁 명중을 위해 노력했지만 수개월 열심히 일하고 나서 뒤늦게 깨닫는 것과 같습니다. “잠깐만, 테스트를 하려면 목표를 이쪽으로 옮겨야겠어” 그러면 팀은 이러겠죠. “잠깐.. 그러면 애초에 왜 다른 과녁에 몇 개월 동안 시간을 낭비하게 한 거야? 과녁 중심이 바뀔 수 있는데 뭐하러 그렇게 열심히 일한 거지?” 라고 반문할 수 있죠.

이런 일을 방지하기 위해 여러분께 권장드리는 부분이 있는데요. 이렇게 무작위로 섞인 데이터를 개발과 시험 세트에 반영합니다. 이렇게 되면 개발 세트와 시험 세트 모두 8개 지역에서 수집된 데이터를 갖게 됩니다. 또 개발과 시험 세트 모두 같은 분포도에서 온 것이고 이 분포도는 모든 데이터들이 섞인 데이터 분포도라고 할 수 있습니다.

---

![image](https://user-images.githubusercontent.com/55765292/180713696-85eabafb-7e93-44df-91b8-a6b704a0a15a.png)

또 다른 예시를 말씀드리겠습니다. 사실 실화입니다만 세부 내용만 조금 바꿨습니다. 제가 알고 있는 팀 중 하나는 개발 세트 최적화에 몇 개월을 들였는데요. 이 개발 세트는 중산층의 우편번호와 대출 승인 내역으로 이루어져 있었습니다. 구체적인 머신러닝 문제는 “대출 신청에 관한 입력값 X로 y를 예측할 수 있을까요? 예상할 수 있을까요?” 였습니다.

이를 통해 대출 승인 결정에 도움을 주는 것이죠 개발 세트는 대출 신청으로 만들어집니다. 중산층의 집코드로 만들어진 것이죠. 집코드는 미국의 우편번호입니다. 이 팀은 몇 개월 작업을 한 뒤 갑자기 저소득층 우편번호 데이터로 시험해보기로 마음먹었습니다. 당연히 중산층의 우편번호 분포 데이터와 저소득층의 우편번호 데이터는 많이 달랐습니다.

이전 사례에서 최적화를 위해 정말 많은 시간을 쏟았음에도 분류기는 후자 사례에서 제대로 작동하지 않았습니다. 결과적으로 이 팀은 약 3개월이라는 시간을 낭비하고 많은 작업을 다시 실행해야 했습니다. 어떤 일이 벌어진 건가 하면 이 팀은 3개월간 오로지 한 가지 목표를 향해 달렸고 3개월 뒤 매니저가 “이렇게 다른 목표를 설정하는데 괜찮은지?" 물었을 때 이는 완전히 다른 지점이었던 것이죠. 이는 팀에게 아주 곤혹스러운 경험으로 남았습니다.

---

![image](https://user-images.githubusercontent.com/55765292/180713723-42564c71-789f-4434-9e6e-97bddad78759.png)

그러므로 제가 권장드리는 것은 개발 세트와 시험 세트를 설정할 때 미래에 어떤 데이터를 반영시킬지와 어떤 것을 중요시 여길지를 고려하여 적합한 개발 세트와 시험 세트를 고르는 것입니다. 그리고 특히 여기 있는 개발 세트와 시험 세트는 모두 같은 분포에서 만들어져야 합니다.

따라서 미래에 어떤 데이터를 다루던 간에 그 경우에 사용한 데이터와 같은 유형의 데이터를 확보하셔야 합니다. 그 데이터가 무엇이건 간에 개발 세트와 시험 세트에 모두 넣으세요. 이렇게 하면 목표를 실제로 여러분이 원하는 곳에 설정하고 팀이 같은 목표를 효율적으로 달성할 수 있게 할 수 있습니다.

훈련 세트를 어떻게 설정하는지는 아직 다루지 않았으므로 나중에 말씀드리겠습니다. 이번에 꼭 기억하셔야 할 내용은 개발 세트 설정과  이는 여러분이 실제로 목표로 삼고 싶은 대상을 정의합니다. 또 가능하면 개발 세트와 시험 세트를 같은 분포도로 설정해 머신러닝 팀이 원하는 어떤 목표도 맞출 수 있도록 하는 것입니다. 훈련 세트를 어떻게 선택하는지에 따라 얼마나 잘 목표를 맞추는지 결정지을 수 있습니다.
