---
title: "[Ⅱ. Deep Neural Network] Optimization Algorithms (4)"
categories:
  - Deep Learning Specialization
tags:
  - Coursera
  - Deep Learning Specialization
  - Tensorflow
  - Deep Learning
  - Mathematical Optimization
  - hyperparameter tuning
toc: true
toc_sticky: true
toc_label: "Optimization Algorithms (4)"
toc_icon: "sticky-note"
---

![image](https://user-images.githubusercontent.com/55765292/177095282-038ee3ed-f543-4793-9eff-f2d5ac239f36.png){: width="50%" height="50%"}{: .align-center}

<br><br>

# Optimization Algorithms

## Optimization Algorithms

### Bias Correction in Exponentially Weighted Averages
어떻게 지수 가중 평균을 적용하는지 살펴보았었습니다. 편향 수정이라고 하는 디테일한 기법이 있는데요. 평균의 계산을 더 정확하게 해줍니다. 어떻게 작동하는 것인지 알아보겠습니다.

![image](https://user-images.githubusercontent.com/55765292/178386506-95d83730-2135-45ed-b14f-7f45c87478b9.png)

이전에 베타에 대한 수치가 0.9인것과 0.98인 것을 보았습니다. 하지만 수식을 구현하면 실제로 베타가 0.98일때 녹색 곡선을 얻지 않을 것이며 실제로 보라색 곡선을 얻게 됩니다. 보라색 곡선이 아주 낮게 시작한다는 것을 알 수 있죠. 어떻게 고칠 수 있는지 보겠습니다.

이동 평균을 구현할 때, $v_0 = 0$으로 초기화합니다. 그리고 나서 $v_1 = 0.98v_0 + 0.02\theta_1$입니다. 그러나 $v_0 = 0$이므로 그냥 소거됩니다. 그래서 $v_1$은 $0.02\theta_2$에 불과합니다. 그렇기 때문에 첫째날의 온도가 화씨40도인 경우, $v_1 = 0.02 \times 40$일 될 것이고, 그것은 0.8이므로 여기서 훨씬 더 낮은 값을 얻게 됩니다.

이건 첫째날의 온도에 대한 그리 좋은 수치가 아닙니다. 쎄타1과 쎄타2가 양수라고 가정합시다. 이것을 계산할 때, $v_2$는 쎄타1 또는 쎄타2 보다 훨씬 작을 것이며, 그래서 $v_2$는 그 해의 첫 이틀간 기온에 대한 좋은 추정치가 압니다. 이 수치를 수정하면 훨씬 더 정확하게 만들고 훨씬 좋은 결과를 얻을 수 있는 방법이 있는 것으로 알려졌으며 특히 추정 초반 부분에 대한 것입니다.

구체적인 예를 들어 보겠습니다. t가 2인 경우, $1 - \beta^t = 1 - (0.98)^2 = 0.0396$입니다. 그러므로 둘째날의 기온 추정치는 $\cfrac{v_2}{0.0396}$이며 이것은 $\cfrac{0.0196\theta_1 + 0.02\theta_2}{0.0396}$가 됩니다.

이는 쎄타1과 쎄타2의 가중 평균이 되고 이것은 이 편향을 제거합니다. 그러므로 t의 값이 커지면서 베타의 t승은 0에 근접해지고, 그것은 t가 충분히 큰 이유입니다. 편향 수정 영향은 없게됩니다. 그러므로 t의 값이 큰 경우 보라색 선과 초록색 선은 상당히 겹치게 됩니다.

그러나 이러한 초기 학습 단계에서 여전히 추정치를 올리고 있을 때에 편향 수정은 온도에 대한 더 나은 추정치를 얻도록 도울 수 있습니다. 이 편향 수정은 보라색 선에서 녹색 선으로 가도록 도와줍니다.

머신 러닝에서 지수 가중 편균의 대부분의 구현에 대해 사람들은 보통 바이어스 수정에 대해 구현하는 것을 신경쓰지 않습니다. 왜냐하면 대부분의 사람들은 오히려 그 초기 기간을 재고 조금 더 편향된 평가를 한 다음 거기서부터 시작하기 때문입니다.

그러나 초기 단계에서 편향에 대해 우려하며 지수 가중 평균이 아직 워밍 업 하는 동안에 그러면 편향 수정은 더 좋은 추정치를 일찍 하는데 도움이 됩니다.

이제 지수 가중 평균에서의 편향 수정도 알게됐습니다. 계속해서 이를 사용하여 더 나은 최적화 알고리즘을 구축해보겠습니다.

