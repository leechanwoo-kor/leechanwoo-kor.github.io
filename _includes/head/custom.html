<!-- start custom head snippets -->

<!-- Canonical URL redirect enforcement -->
<script>
  // Enforce canonical URL (www -> non-www or http -> https)
  if (window.location.host === 'www.leechanwoo-kor.github.io') {
    window.location.replace('https://leechanwoo-kor.github.io' + window.location.pathname + window.location.search + window.location.hash);
  }
</script>

<!-- DNS Prefetch for external resources -->
<link rel="dns-prefetch" href="//cdn.jsdelivr.net">
<link rel="dns-prefetch" href="//pagead2.googlesyndication.com">
<link rel="dns-prefetch" href="//googletagmanager.com">
<link rel="dns-prefetch" href="//fundingchoicesmessages.google.com">
<link rel="dns-prefetch" href="//www.google-analytics.com">
<link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
<link rel="preconnect" href="https://pagead2.googlesyndication.com" crossorigin>
<link rel="preconnect" href="https://www.google-analytics.com" crossorigin>

<!-- insert favicons. use https://realfavicongenerator.net/ -->
<link rel="apple-touch-icon" sizes="180x180" href="{{site.baseurl}}/assets/logo.ico/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="{{site.baseurl}}/assets/logo.ico/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="{{site.baseurl}}/assets/logo.ico/favicon-16x16.png">
<link rel="manifest" href="{{site.baseurl}}/assets/logo.ico/site.webmanifest">
<link rel="mask-icon" href="{{site.baseurl}}/assets/logo.ico/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">

<!-- 소셜 미디어 메타 태그 강화 -->
<meta property="og:locale" content="ko_KR">
<meta property="og:type" content="{% if page.date %}article{% else %}website{% endif %}">
<meta property="og:site_name" content="{{ site.title }}">
{% if page.title %}
<meta property="og:title" content="{{ page.title }}">
<meta name="twitter:title" content="{{ page.title }}">
{% endif %}
{% if page.excerpt %}
<meta property="og:description" content="{{ page.excerpt | strip_html | truncate: 160 }}">
<meta name="twitter:description" content="{{ page.excerpt | strip_html | truncate: 160 }}">
{% endif %}
{% if page.header.image %}
<meta property="og:image" content="{{ site.url }}{{ page.header.image }}">
<meta name="twitter:image" content="{{ site.url }}{{ page.header.image }}">
{% elsif site.og_image %}
<meta property="og:image" content="{{ site.url }}{{ site.og_image }}">
<meta name="twitter:image" content="{{ site.url }}{{ site.og_image }}">
{% endif %}
<meta name="twitter:card" content="summary_large_image">
{% if site.twitter.username %}
<meta name="twitter:site" content="@{{ site.twitter.username }}">
{% endif %}

<!-- Custom CSS - preload for performance -->
<link rel="preload" href="{{site.baseurl}}/assets/css/custom/custom.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="{{site.baseurl}}/assets/css/custom/custom.css"></noscript>

<!-- Google Adsense - lazy load after page is interactive -->
<script>
  // Load AdSense only after page is fully interactive
  function loadAdsense() {
    if (window.adsbygoogleLoaded) return;
    window.adsbygoogleLoaded = true;
    var script = document.createElement('script');
    script.src = 'https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6158389106191012';
    script.crossOrigin = 'anonymous';
    script.async = true;
    document.body.appendChild(script);
  }
  // Use requestIdleCallback for non-critical ad loading
  if ('requestIdleCallback' in window) {
    requestIdleCallback(loadAdsense, { timeout: 3000 });
  } else {
    // Fallback: load after window load event
    window.addEventListener('load', function() {
      setTimeout(loadAdsense, 1000);
    });
  }
</script>

<script type="module">
  import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@11/dist/mermaid.esm.min.mjs';
  mermaid.initialize({ 
    startOnLoad: true,
    theme: 'dark'  /* minimal_mistakes_skin: "dark"를 쓰고 계시므로 다크 테마 적용 */
  });
</script>

<!-- end custom head snippets -->
